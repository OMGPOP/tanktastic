<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>

  <head>

    <title>Tanktastic!</title>

    <script type="text/javascript" src="lib/easeljs-0.4.2.min.js"></script>
    <script type="text/javascript" src="lib/seedrandom.js"></script>
    <script type="text/javascript" src="lib/tanktastic.js"></script>

    <script type="text/javascript">
        var stage;
        var required = [];
        var tanks = [
            "lib/example-tanks/moron.js",
            "lib/example-tanks/aggressivo.js",
            "lib/example-tanks/coward.js",
            "lib/example-tanks/coward.js",
            "lib/example-tanks/coward.js",
            "lib/example-tanks/coward.js",
              ];
        exports = null;
        var game;

        function startGame()
        {
          stage = new Stage("arena");
          var shape = stage.addChild(new Shape());
          game = new tanktastic.Game(window.location.search, shape.graphics);
          for(var i in required) game.register_tank(required[i]);
          Ticker.addListener(window);
        }

        function appendTank(file)
        {
          exports = {};
          required.push(exports);
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = file + "?r=" + Math.random();
          document.getElementsByTagName("HEAD")[0].appendChild(script);
          resolve();
        }

        function resolve()
        {
          if(exports && !exports.name)
          {
            setTimeout(resolve, 5);
            return;
          }
          if(tanks.length) appendTank(tanks.pop());
          else startGame();
        }

        function tick()
        {
          if(!game.is_complete())
          {
            game.step();
            stage.update();
          }
        }

    </script>

  </head>

  <body onload="resolve();">
    <canvas id="arena" width="960" height="480"></canvas>
  </body>

</html>
